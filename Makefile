.PHONY: help build up down logs shell migrate studio clean

# –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –≤–≤–æ–¥–µ 'make' –±—É–¥–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å—Å—è —Å–ø—Ä–∞–≤–∫–∞
.DEFAULT_GOAL := help

# --- –û–°–ù–û–í–ù–´–ï –ö–û–ú–ê–ù–î–´ ---

up: ## üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç (–≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ)
	docker-compose up -d --build

dev: ## üíª –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç —Å –ª–æ–≥–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
	docker-compose up --build

down: ## üõë –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
	docker-compose down

stop: ## ‚è∏Ô∏è –ü–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É (–±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è)
	docker-compose stop

logs: ## üìù –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
	docker-compose logs -f

# --- –†–ê–ë–û–¢–ê –° –ë–ê–ó–û–ô –î–ê–ù–ù–´–• (PRISMA) ---

db-migrate: ## üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î (–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ schema.prisma)
	npx prisma migrate dev

db-studio: ## üìä –û—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω–∫—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ –±—Ä–∞—É–∑–µ—Ä–µ (http://localhost:5555)
	npx prisma studio

db-seed: ## üå± –ó–∞–ø–æ–ª–Ω–∏—Ç—å –±–∞–∑—É —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å seed)
	npx prisma db seed

# --- –£–¢–ò–õ–ò–¢–´ ---

shell: ## üêö –ó–∞–π—Ç–∏ –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å Node.js (–∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞)
	docker-compose exec web sh

clean: ## üóëÔ∏è –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞: —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ –¢–û–ú–ê (—É–¥–∞–ª–∏—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö!)
	docker-compose down -v

help: ## ‚ÑπÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-15s\033[0m %s\n", $$1, $$2}'